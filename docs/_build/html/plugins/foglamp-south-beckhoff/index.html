

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Beckhoff TwinCAT &mdash; FogLAMP  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="FogLAMP  documentation" href="../../index.html"/>
        <link rel="up" title="FogLAMP South Plugins" href="../south.html"/>
        <link rel="next" title="Digiducer Vibration Sensor" href="../foglamp-south-digiducer/index.html"/>
        <link rel="prev" title="Advantech USB-4704" href="../foglamp-south-usb4704/index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> FogLAMP
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quick_start.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../processing_data.html">Processing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../foglamp_architecture.html">FogLAMP Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../foglamp_plugins.html">FogLAMP Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../securing_foglamp.html">Securing FogLAMP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notifications.html">Notifications Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plugin_developers_guide/index.html">Plugin Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rest_api_guide/index.html">REST API Developers Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../build_index.html">Building FogLAMP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../91_version_history.html">Version History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../92_downloads.html">Downloads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../KERBEROS.html">Kerberos authentication</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../plugin_index.html">Plugin Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../south.html">FogLAMP South Plugins</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-am2315/index.html">AM2315 Temperature &amp; Humidity Sensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-cc2650/index.html">CC2650 SensorTag</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-coap/index.html">CoAP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-csv/index.html">Simple CSV Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-dht/index.html">DHT11 (C version)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-dht11/index.html">DHT11 (Python version)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-dnp3/index.html">DNP3 Master Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-envirophat/index.html">Enviro pHAT Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-expression/index.html">Expression South Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-FlirAX8/index.html">Flir AX8 Thermal Imaging Camera</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-http/index.html">South HTTP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-ina219/index.html">INA219 Voltage &amp; Current Sensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-modbus-c/index.html">Modbus South Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-mqtt-sparkplug/index.html">MQTT Sparkplug B</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-opcua/index.html">OPC/UA South Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-playback/index.html">Playback Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-pt100/index.html">PT100 Temperature Sensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-random/index.html">Random</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-randomwalk/index.html">Random Walk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-sensehat/index.html">SenseHAT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-sinusoid/index.html">Sinusoid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-systeminfo/index.html">System Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-usb4704/index.html">Advantech USB-4704</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Beckhoff TwinCAT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#map-format">Map Format</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../foglamp-south-digiducer/index.html">Digiducer Vibration Sensor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../north.html">FogLAMP North Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filter.html">FogLAMP Filter Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rule.html">FogLAMP Notification Rule Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notify.html">FogLAMP Notification Delivery Plugins</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">FogLAMP</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../plugin_index.html">Plugin Documentation</a> &raquo;</li>
        
          <li><a href="../south.html">FogLAMP South Plugins</a> &raquo;</li>
        
      <li>Beckhoff TwinCAT</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/plugins/foglamp-south-beckhoff/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="beckhoff-twincat">
<h1>Beckhoff TwinCAT<a class="headerlink" href="#beckhoff-twincat" title="Permalink to this headline">¶</a></h1>
<p>The <em>foglamp-south-beckhoff</em> plugin is a plugin that allows collection of data from Beckhoff PLC’s using the TwinCAT 2 or TwinCAT 3 protocols. It utilises the ADS library to allow updates the the values held within the PLC to be captured in FogLAMP and sent onward as with any other data in FogLAMP.</p>
<p>The plugin uses a subscription model to register for changes to variables within the PLC and each of these becomes a data point in the asset that is created within FogLAMP.</p>
<p>To create a south service with the Beckhoff TwinCAT plugin</p>
<blockquote>
<div><ul class="simple">
<li>Click on <em>South</em> in the left hand menu bar</li>
<li>Select <em>Beckhoff</em> from the plugin list</li>
<li>Name your service and click <em>Next</em></li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><img alt="beckhoff_1" src="../../_images/beckhoff_1.jpg" /></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Configure the plugin<ul>
<li><strong>Asset Name</strong>: The default asset name that is used for the data that is extracted from the PLC if the map does not define an explicit asset name.</li>
<li><strong>EtherCAT Server</strong>: The hostname or IP address of the ADS maser, this is the IP address of the Beckhoff PLC.</li>
<li><strong>Remote NetId</strong>: The Beckhoff netId of the PLC. This is normally the IP address of the PLC with .1.1 appended to it.</li>
<li><strong>Protocol</strong>: Define if the Automatic, TwinCAT 2 or TwinCAT 3 protocol is to be used. If <em>Automatic</em> is chosen the plugin will attempt to determine if the PLC supports TwinCAT 2 or TwinCAT 3.</li>
<li><strong>TwinCAT Map</strong>: A JSON document that is the data mapping for the PLC. This defines what variables are to be extracted from the PLC. See below for details of the map format.</li>
</ul>
</li>
</ul>
</div></blockquote>
<div class="section" id="map-format">
<h2>Map Format<a class="headerlink" href="#map-format" title="Permalink to this headline">¶</a></h2>
<p>The map is a JSON document that describes the variables to be extracted
from the PLC. The variables may be defined either by name or by group
and index id. Each variable will become a datapoint with the asset added
to FogLAMP. The map itself is a single JSON array called “items”, with
each element in the array being an object that define the variable and
what to do with it.</p>
<p>These objects have the following members within them</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>asset</td>
<td>An optional element that defines an asset code that should be used to
store the variable. If this is not given then the default asset code
for the plugin is used.</td>
</tr>
<tr class="row-odd"><td>datapoint</td>
<td>The name of the datapoint into which the variable is stored within
the asset code. The datapoint name must be given for each object in
the map.</td>
</tr>
<tr class="row-even"><td>name</td>
<td>The variable name within the PLC that is extracted. This may be obtained
either by examining the PLC code that is running or by extracted from
the .TPY file for the PLC. Either name or group and index must be
given for each item in the map.</td>
</tr>
<tr class="row-odd"><td>group</td>
<td>The numeric group within the PLC from which data is extracted. This
allow data to be extracted without the use of variable names. It is not
recommended for production use as it is very dependent on the layout of
the PLC code, using variable names is more robust than group and index.</td>
</tr>
<tr class="row-even"><td>index</td>
<td>The numeric index within the group from which to extract data, see above.</td>
</tr>
</tbody>
</table>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>An example TwinCAT map is should below</p>
<div class="highlight-JSON"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;items&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;datapoint&quot;</span><span class="p">:</span> <span class="s2">&quot;engine&quot;</span><span class="p">,</span>
      <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;MAIN.engine&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is based on the simulation that is available from Beckhoff and creates a single data point within the default asset called engine. It is populates with the value of the internal PLC variable <em>MAIN.engine</em>. A new asset will be created and added to the FogLAMP buffer every time this variable changes.</p>
</div>
<div class="section" id="testing">
<h3>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h3>
<p>The easiest way to test the Beckhoff plugin is to setup a simulation
on a windows machine and run the Beckhoff PLC in simulator mode. The
Beckhoff PLC can be freely downloaded from the Beckhoff site.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">https://beckhoff.co.uk/english/download/tc3-downloads.htm?id=1905053019883865</span>
</pre></div>
</div>
<p>This is designed to be run on a Windows 7 machine.</p>
<p>You can then create some sample variables to try to link to.</p>
<p>Downloading the code from Beckhoff includes a simple example that can
be run that defines an engine variable, this is the example for which
the default configuration is setup for.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You will need to setup a static route in the Beckhoff PLC with the AMSNetId and IP address for the plugin and the type as TCP/IP.</p>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../foglamp-south-digiducer/index.html" class="btn btn-neutral float-right" title="Digiducer Vibration Sensor" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../foglamp-south-usb4704/index.html" class="btn btn-neutral" title="Advantech USB-4704" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Dianomic Systems.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>